<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Inventory Scanner</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <script src="https://unpkg.com/lucide@latest"></script>
        <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
        <style>
            /* Custom scrollbar for cleaner look */
            ::-webkit-scrollbar {
                width: 8px;
            }
            ::-webkit-scrollbar-track {
                background: #f1f5f9;
            }
            ::-webkit-scrollbar-thumb {
                background: #cbd5e1;
                border-radius: 4px;
            }
            ::-webkit-scrollbar-thumb:hover {
                background: #94a3b8;
            }
            .fade-in {
                animation: fadeIn 0.3s ease-out;
            }
            @keyframes fadeIn {
                from {
                    opacity: 0;
                    transform: translateY(5px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
            #reader {
                width: 100%;
                border-radius: 0.75rem;
                overflow: hidden;
            }
        </style>
    </head>
    <body class="bg-gray-100 min-h-screen font-sans text-slate-800 p-4">
        <div class="max-w-md mx-auto space-y-4">
            <div
                class="bg-white p-4 rounded-xl shadow-sm border border-slate-200 flex items-center justify-between"
            >
                <div class="flex items-center gap-3">
                    <div class="bg-blue-600 p-2 rounded-lg text-white">
                        <i data-lucide="barcode" class="w-6 h-6"></i>
                    </div>
                    <div>
                        <h1 class="font-bold text-lg leading-tight">
                            Inventory Scanner
                        </h1>
                        <p id="status-text" class="text-xs text-slate-500">
                            Waiting to sync...
                        </p>
                    </div>
                </div>
            </div>

            <div
                id="error-banner"
                class="hidden bg-red-50 text-red-700 p-4 rounded-xl border border-red-200 text-sm flex gap-3 items-start"
            >
                <i
                    data-lucide="alert-circle"
                    class="shrink-0 mt-0.5 w-5 h-5"
                ></i>
                <div>
                    <p class="font-semibold">Connection Error</p>
                    <p id="error-msg">Unknown error</p>
                    <button
                        onclick="fetchData()"
                        class="mt-2 px-3 py-1 bg-red-100 hover:bg-red-200 text-red-800 rounded-md text-xs font-medium transition-colors"
                    >
                        Retry Connection
                    </button>
                </div>
            </div>

            <div id="settings-panel" class="hidden">
                 <input id="sheet-id" type="text" value="1eEFtb7wxOOLw-TFTf_NvSFq1VQy1qYlMoVmiZkFgUys" />
                 <input id="gid-id" type="text" value="710656272" />
            </div>

            <div
                class="bg-white p-6 rounded-xl shadow-sm border border-slate-200 space-y-4"
            >
                <div id="camera-section" class="space-y-2">
                    <button 
                        id="camera-toggle-btn"
                        onclick="toggleCamera()"
                        class="w-full py-2 bg-blue-100 text-blue-700 rounded-lg text-sm font-semibold hover:bg-blue-200 flex items-center justify-center gap-2 transition-colors"
                    >
                        <i data-lucide="camera" class="w-4 h-4"></i>
                        Open Camera to Scan
                    </button>
                    
                    <div id="reader-container" class="hidden bg-black rounded-xl overflow-hidden relative">
                         <div id="reader"></div>
                         <button onclick="stopCamera()" class="absolute top-2 right-2 bg-white/80 p-1 rounded-full text-red-600">
                            <i data-lucide="x" class="w-4 h-4"></i>
                         </button>
                    </div>
                </div>
                <div>
                    <label
                        class="block text-sm font-semibold text-slate-700 mb-2"
                        >Scan Barcode (Exact Match)</label
                    >
                    <div class="relative">
                        <i
                            data-lucide="barcode"
                            class="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 w-5 h-5"
                        ></i>
                        <input
                            id="id-search-input"
                            type="text"
                            inputmode="numeric"
                            pattern="[0-9]*"
                            placeholder="e.g. 9900114..."
                            class="w-full pl-10 pr-4 py-3 text-lg border-2 border-slate-200 rounded-xl focus:border-blue-500 focus:ring-4 focus:ring-blue-500/10 outline-none transition-all placeholder:text-slate-300 font-mono"
                            oninput="handleSearch()"
                            autofocus
                        />
                    </div>
                </div>

                <div class="relative flex justify-center items-center py-2">
                    <div
                        class="absolute inset-0 border-t border-slate-200"
                    ></div>
                    <span
                        class="relative bg-white px-3 text-xs text-slate-400 font-medium"
                        >OR</span
                    >
                </div>

                <div>
                    <label
                        class="block text-sm font-semibold text-slate-700 mb-2"
                        >Search by Product Name (Min 3 Chars)</label
                    >
                    <div class="relative">
                        <i
                            data-lucide="tag"
                            class="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 w-5 h-5"
                        ></i>
                        <input
                            id="name-search-input"
                            type="text"
                            placeholder="e.g. noor 1.5"
                            class="w-full pl-10 pr-4 py-3 text-lg border-2 border-slate-200 rounded-xl focus:border-blue-500 focus:ring-4 focus:ring-blue-500/10 outline-none transition-all placeholder:text-slate-300"
                            oninput="handleSearch()"
                        />
                    </div>
                </div>

                <p
                    id="search-status"
                    class="text-center text-xs text-slate-400 mt-3"
                >
                    Waiting for data...
                </p>
            </div>

            <div id="result-container" class="hidden space-y-2 fade-in">
                <h3
                    class="text-xs font-bold text-slate-400 uppercase tracking-wider ml-1"
                >
                    Details for Selected Item
                </h3>

                <div
                    class="bg-white rounded-xl shadow-lg border border-blue-100 overflow-hidden"
                >
                    <div class="bg-blue-50 p-4 border-b border-blue-100">
                        <p class="text-xs font-bold text-blue-600 mb-1">
                            ITEM DETAILS
                        </p>
                        <h2
                            id="result-title"
                            class="text-xl font-bold text-slate-800 font-mono"
                        >
                            Product Name
                        </h2>
                    </div>
                    <div
                        id="result-details"
                        class="p-4 divide-y divide-slate-100"
                    ></div>
                </div>
            </div>

            <div id="list-container" class="hidden space-y-2 fade-in">
                <h3
                    class="text-xs font-bold text-slate-400 uppercase tracking-wider ml-1"
                >
                    Multiple Matches Found
                </h3>
                <div
                    id="match-list"
                    class="bg-white rounded-xl shadow-lg border border-slate-200 divide-y divide-slate-100"
                ></div>
